# Hugging Face Transformers Amazon SageMaker 예제

[Amazon SageMaker](https://docs.aws.amazon.com/sagemaker/latest/dg/whatis.html) 및 [Amazon SageMaker Python SDK](https://sagemaker.readthedocs.io/en/stable/)를 사용하여 [Hugging Face Transformers](https://github.com/huggingface/transformers)를 빌드, 학습 및 배포하는 방법을 보여주는 예제 Jupyter 노트북입니다.


## 🛠️ 설정


예제 노트북을 실행하기 위한 가장 빠른 설정은 다음과 같습니다.
- [AWS 계정](http://docs.aws.amazon.com/sagemaker/latest/dg/gs-account.html)
- 적절한 [IAM 사용자 및 역할](http://docs.aws.amazon.com/sagemaker/latest/dg/authentication-and-access-control.html) 설정
- [Amazon SageMaker Notebook Instance](http://docs.aws.amazon.com/sagemaker/latest/dg/gs-setup-working-env.html)
- [S3 버킷](http://docs.aws.amazon.com/sagemaker/latest/dg/gs-config-permissions.html)

## 📓 예제

| 노트북                                                                                                                                                                               | 유형      | 설명                                                                                                                                                                                                                |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [01 PyTorch 시작하기](https://github.com/huggingface/notebooks/blob/main/sagemaker/01_getting_started_pytorch/sagemaker-notebook.ipynb)                                    | 학습  | PyTorch를 사용하여 텍스트 분류를 위해 사전 학습된 Hugging Face Transformer를 미세 조정하는 방법에 대한 엔드투엔드 시작 예제입니다.                                                                                        |
| [02 TensorFlow 시작하기](https://github.com/huggingface/notebooks/blob/main/sagemaker/02_getting_started_tensorflow/sagemaker-notebook.ipynb)                              | 학습  | TensorFlow를 사용하여 텍스트 분류를 위해 사전 학습된 Hugging Face Transformer를 미세 조정하는 방법에 대한 엔드투엔드 시작 예제입니다.                                                                                     |
| [03 분산 학습: 데이터 병렬 처리](https://github.com/huggingface/notebooks/blob/main/sagemaker/03_distributed_training_data_parallelism/sagemaker-notebook.ipynb)            | 학습  | Amazon SageMaker 데이터 병렬 처리를 사용하여 질문 답변을 위해 사전 학습된 Hugging Face Transformer를 미세 조정하기 위해 데이터 병렬 처리 전략으로 분산 학습을 사용하는 방법에 대한 엔드투엔드 예제입니다.                 |
| [04 분산 학습: 모델 병렬 처리](https://github.com/huggingface/notebooks/blob/main/sagemaker/04_distributed_training_model_parallelism/sagemaker-notebook.ipynb)          | 학습  | Amazon SageMaker 모델 병렬 처리를 사용하여 사전 학습된 Hugging Face Transformer에 모델 병렬 처리 전략으로 분산 학습을 사용하는 방법에 대한 엔드투엔드 예제입니다.                                                     |
| [05 스팟 인스턴스 및 체크포인트 사용 방법](https://github.com/huggingface/notebooks/blob/main/sagemaker/05_spot_instances/sagemaker-notebook.ipynb)                                | 학습  | 스팟 인스턴스 및 체크포인트를 사용하여 학습 비용을 줄이는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                  |
| [06 SageMaker Metrics를 사용한 실험 추적](https://github.com/huggingface/notebooks/blob/main/sagemaker/06_sagemaker_metrics/sagemaker-notebook.ipynb)                            | 학습  | SageMaker 메트릭을 사용하여 실험 및 학습 작업을 추적하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                             |
| [07 분산 학습: 데이터 병렬 처리](https://github.com/huggingface/notebooks/blob/main/sagemaker/07_tensorflow_distributed_training_data_parallelism/sagemaker-notebook.ipynb) | 학습  | TensorFlow와 함께 Amazon SageMaker 데이터 병렬 처리를 사용하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                         |
| [08 분산 학습: T5/BART를 사용한 요약](https://github.com/huggingface/notebooks/blob/main/sagemaker/08_distributed_summarization_bart_t5/sagemaker-notebook.ipynb)      | 학습  | Amazon SageMaker 데이터 병렬 처리를 사용하여 요약을 위해 BART/T5를 미세 조정하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                   |
| [09 비전: ViT 미세 조정](https://github.com/huggingface/notebooks/blob/main/sagemaker/09_image_classification_vision_transformer/sagemaker-notebook.ipynb)                           | 학습  | 이미지 분류를 위해 Vision Transformer를 미세 조정하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                         |
| [10 Amazon S3에서 HF Transformer 배포](https://github.com/huggingface/notebooks/blob/main/sagemaker/10_deploy_model_from_s3/deploy_transformer_model_from_s3.ipynb)                 | 추론 | Amazon S3에서 모델을 배포하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                                                 |
| [11 Hugging Face Hub에서 HF Transformer 배포](https://github.com/huggingface/notebooks/blob/main/sagemaker/11_deploy_model_from_hf_hub/deploy_transformer_model_from_hf_hub.ipynb)  | 추론 | Hugging Face Hub에서 모델을 배포하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                                      |
| [12 Amazon SageMaker Batch Transform을 사용한 배치 처리](https://github.com/huggingface/notebooks/blob/main/sagemaker/12_batch_transform_inference/sagemaker-notebook.ipynb)        | 추론 | Amazon SageMaker Batch Transform으로 배치 처리를 수행하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                     |
| [13 SageMaker 엔드포인트 자동 확장](https://github.com/huggingface/notebooks/blob/main/sagemaker/13_deploy_and_autoscaling_transformers/sagemaker-notebook.ipynb)                     | 추론 | HF 엔드포인트에 자동 확장을 사용하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                                             |
| [14 미세 조정 및 Hub에 푸시](https://github.com/huggingface/notebooks/blob/main/sagemaker/14_train_and_push_to_hub/sagemaker-notebook.ipynb)                                         | 학습  | 학습 중 체크포인트 저장을 위해 Hugging Face Hub를 MLOps 백엔드로 사용하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                              |
| [15 학습 컴파일러](https://github.com/huggingface/notebooks/blob/main/sagemaker/15_training_compiler/sagemaker-notebook.ipynb)                                                     | 학습  | Amazon SageMaker Training Compiler를 사용하여 학습 시간을 단축하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                              |
| [16 비동기 추론](https://github.com/huggingface/notebooks/blob/main/sagemaker/16_async_inference_hf_hub/sagemaker-notebook.ipynb)                                           | 추론 | Hugging Face Transformers와 함께 Amazon SageMaker 비동기 추론 엔드포인트를 사용하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                          |
| [17 사용자 지정 inference.py 스크립트](https://github.com/huggingface/notebooks/blob/main/sagemaker/17_custom_inference_script/sagemaker-notebook.ipynb)                                      | 추론 | Sentence Transformers 및 문장 임베딩을 위해 사용자 지정 inference.py를 만드는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                |
| [18 AWS Inferentia](https://github.com/huggingface/notebooks/blob/main/sagemaker/18_inferentia_inference/sagemaker-notebook.ipynb)                                                     | 추론 | AWS Inferentia를 사용하여 추론 시간을 단축하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                                     |
| [19 서버리스 추론](https://github.com/huggingface/notebooks/blob/main/sagemaker/19_serverless_inference/sagemaker-notebook.ipynb)                                               | 추론 | 비용 절감을 위한 서버리스 추론 예제입니다.                                                                                                                                                                                  |
| [20 자동 음성 인식](https://github.com/huggingface/notebooks/blob/main/sagemaker/20_automatic_speech_recognition_inference/sagemaker-notebook.ipynb)                     | 추론 | wav2vec2로 음성 인식을 수행하는 방법 예제입니다.                                                                                                                                                                         |
| [21 이미지 분할](https://github.com/huggingface/notebooks/blob/main/sagemaker/21_image_segmantation/sagemaker-notebook.ipynb)                                                   | 추론 | segformer로 이미지 분할을 수행하는 방법 예제입니다.                                                                                                                                                                        |
| [22 Accelerate AWS SageMaker 통합 예제](https://github.com/huggingface/notebooks/blob/main/sagemaker/22_accelerate_sagemaker_examples/README.md)                            | 학습  | Accelerate의 AWS SageMaker 통합을 사용하는 방법에 대한 엔드투엔드 예제입니다.                                                                                                                                                  |
| [23 Stable Diffusion](https://github.com/huggingface/notebooks/blob/main/sagemaker/23_stable_diffusion_inference/sagemaker-notebook.ipynb)                                             | 추론 | Stable Diffusion으로 이미지를 생성하는 방법 예제입니다.                                                                                                                                                                       |
| [24 PEFT로 BLOOM 학습](https://github.com/huggingface/notebooks/blob/main/sagemaker/24_train_bloom_peft_lora/sagemaker-notebook.ipynb)                                             | 학습  | PEFT 및 LoRA를 사용하여 단일 GPU에서 BLOOM을 학습하는 방법 예제입니다.                                                                                                                                                               |
| [25 PyTorch FSDP 모델 병렬 처리](https://github.com/huggingface/notebooks/blob/main/sagemaker/25_pytorch_fsdp_model_parallelism/sagemaker-notebook.ipynb)                           | 학습  | PyTorch FSDP를 사용하여 다중 노드 다중 GPU에서 LLM을 학습하는 방법 예제입니다.                                                                                                                                                        |
| [26 Document AI Donut](https://github.com/huggingface/notebooks/blob/main/sagemaker/26_document_ai_donut/sagemaker-notebook.ipynb)                                                     | 학습  | 이 튜토리얼에서는 Hugging Face Transformers 및 Amazon SageMaker를 사용하여 문서 이해/문서 구문 분석을 위해 [Donut-base](https://huggingface.co/naver-clova-ix/donut-base)를 미세 조정하고 배포하는 방법을 배웁니다. |
| [27 대규모 언어 모델 배포](https://github.com/huggingface/notebooks/blob/main/sagemaker/27_deploy_large_language_models/sagemaker-notebook.ipynb)                               | 추론 | Hugging Face LLM DLC를 사용하여 LLM을 배포하는 방법을 배웁니다.                                                                                                                                                                     |
| [28 QLora로 LLM 학습](https://github.com/huggingface/notebooks/blob/main/notebooks/sagemaker/28_train_llms_with_qlora/sagemaker-notebook.ipynb)                                   | 학습  | Q-Lora를 사용하여 LLM을 미세 조정하는 방법 예제입니다.                                                                                                                                                                              |
| [29 Inferentia2로 LLM 배포](https://github.com/huggingface/notebooks/blob/main/notebooks/sagemaker/29_deploy_llms_on_inferentia2/sagemaker-notebook.ipynb)                       | 추론 | AWS Inferentia2를 사용하여 LLM을 배포하는 방법을 배웁니다.                                                                                                                                                                             |
| [30 ligtheval로 LLM 평가](https://github.com/huggingface/notebooks/blob/main/notebooks/sagemaker/30_evaluate_llms_with_lighteval/sagemaker-notebook.ipynb)                     | 추론 | Hugging Face LightEval을 사용하여 LLM을 평가하는 방법을 배웁니다.                                                                                                                                                                    |
| [31 TEI로 임베딩 모델 배포](https://github.com/huggingface/notebooks/blob/main/notebooks/sagemaker/31_deploy_embedding_models/sagemaker-notebook.ipynb)                      | 추론 | Hugging Face TEI를 사용하여 RAG 애플리케이션용 임베딩 모델을 배포하는 방법을 배웁니다.                                                                                                                                            |
| [32 임베딩 모델 학습 및 배포](https://github.com/huggingface/notebooks/blob/main/notebooks/sagemaker/32_train_deploy_embedding_models/sagemaker-notebook.ipynb)                      | 학습 및 추론 | Sentence Transformers 및 TEI를 사용하여 임베딩 모델을 학습하고 배포하는 방법을 배웁니다.                                                                                                                                            |
